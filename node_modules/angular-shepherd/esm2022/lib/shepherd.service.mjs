import { Injectable } from '@angular/core';
import Shepherd from 'shepherd.js';
import { elementIsHidden } from './utils/dom';
import { makeButton } from './utils/buttons';
import * as i0 from "@angular/core";
export class ShepherdService {
    constructor() {
        this.confirmCancel = false;
        this.confirmCancelMessage = null;
        this.defaultStepOptions = {};
        this.errorTitle = null;
        this.isActive = false;
        this.keyboardNavigation = true;
        this.messageForUser = null;
        this.modal = false;
        this.requiredElements = [];
        this.tourName = undefined;
        this.tourObject = null;
        this.exitOnEsc = true;
    }
    /**
     * Get the tour object and call back
     */
    back() {
        this.tourObject.back();
    }
    /**
     * Cancel the tour
     */
    cancel() {
        this.tourObject.cancel();
    }
    /**
     * Complete the tour
     */
    complete() {
        this.tourObject.complete();
    }
    /**
     * Hides the current step
     */
    hide() {
        this.tourObject.hide();
    }
    /**
     * Advance the tour to the next step
     */
    next() {
        this.tourObject.next();
    }
    /**
     * Show a specific step, by passing its id
     * @param id The id of the step you want to show
     */
    show(id) {
        this.tourObject.show(id);
    }
    /**
     * Start the tour
     */
    start() {
        this.isActive = true;
        this.tourObject.start();
    }
    /**
     * This function is called when a tour is completed or cancelled to initiate cleanup.
     * @param completeOrCancel 'complete' or 'cancel'
     */
    onTourFinish(completeOrCancel) {
        this.isActive = false;
    }
    /**
     * Take a set of steps and create a tour object based on the current configuration
     * @param steps An array of steps
     */
    addSteps(steps) {
        this._initialize();
        const tour = this.tourObject;
        // Return nothing if there are no steps
        if (!steps || !Array.isArray(steps) || steps.length === 0) {
            return;
        }
        if (!this.requiredElementsPresent()) {
            tour.addStep({
                buttons: [{
                        text: 'Exit',
                        action: tour.cancel
                    }],
                id: 'error',
                title: this.errorTitle,
                text: [this.messageForUser]
            });
            return;
        }
        steps.forEach((step) => {
            if (step.buttons) {
                step.buttons = step.buttons.map(makeButton.bind(this), this);
            }
            tour.addStep(step);
        });
    }
    /**
     * Observes the array of requiredElements, which are the elements that must be present at the start of the tour,
     * and determines if they exist, and are visible, if either is false, it will stop the tour from executing.
     */
    requiredElementsPresent() {
        let allElementsPresent = true;
        /* istanbul ignore next: also can't test this due to things attached to root blowing up tests */
        this.requiredElements.forEach((element) => {
            const selectedElement = document.querySelector(element.selector);
            if (allElementsPresent && (!selectedElement || elementIsHidden(selectedElement))) {
                allElementsPresent = false;
                this.errorTitle = element.title;
                this.messageForUser = element.message;
            }
        });
        return allElementsPresent;
    }
    /**
     * Initializes the tour, creates a new Shepherd.Tour. sets options, and binds events
     */
    _initialize() {
        const tourObject = new Shepherd.Tour({
            confirmCancel: this.confirmCancel,
            confirmCancelMessage: this.confirmCancelMessage,
            defaultStepOptions: this.defaultStepOptions,
            keyboardNavigation: this.keyboardNavigation,
            tourName: this.tourName,
            useModalOverlay: this.modal,
            exitOnEsc: this.exitOnEsc
        });
        tourObject.on('complete', this.onTourFinish.bind(this, 'complete'));
        tourObject.on('cancel', this.onTourFinish.bind(this, 'cancel'));
        this.tourObject = tourObject;
    }
    /** @nocollapse */ static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.0.0", ngImport: i0, type: ShepherdService, deps: [], target: i0.ɵɵFactoryTarget.Injectable }); }
    /** @nocollapse */ static { this.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "18.0.0", ngImport: i0, type: ShepherdService, providedIn: 'root' }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.0.0", ngImport: i0, type: ShepherdService, decorators: [{
            type: Injectable,
            args: [{
                    providedIn: 'root'
                }]
        }], ctorParameters: () => [] });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2hlcGhlcmQuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Byb2plY3RzL3NoZXBoZXJkL3NyYy9saWIvc2hlcGhlcmQuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNDLE9BQU8sUUFBUSxNQUFNLGFBQWEsQ0FBQztBQUNuQyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sYUFBYSxDQUFDO0FBQzlDLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQzs7QUFLN0MsTUFBTSxPQUFPLGVBQWU7SUFjMUI7UUFiQSxrQkFBYSxHQUFHLEtBQUssQ0FBQztRQUN0Qix5QkFBb0IsR0FBVyxJQUFJLENBQUM7UUFDcEMsdUJBQWtCLEdBQXFCLEVBQUUsQ0FBQztRQUMxQyxlQUFVLEdBQUcsSUFBSSxDQUFDO1FBQ2xCLGFBQVEsR0FBRyxLQUFLLENBQUM7UUFDakIsdUJBQWtCLEdBQUcsSUFBSSxDQUFDO1FBQzFCLG1CQUFjLEdBQVcsSUFBSSxDQUFDO1FBQzlCLFVBQUssR0FBRyxLQUFLLENBQUM7UUFDZCxxQkFBZ0IsR0FBRyxFQUFFLENBQUM7UUFDdEIsYUFBUSxHQUFHLFNBQVMsQ0FBQztRQUNyQixlQUFVLEdBQWtCLElBQUksQ0FBQztRQUNqQyxjQUFTLEdBQUcsSUFBSSxDQUFDO0lBR2pCLENBQUM7SUFFRDs7T0FFRztJQUNILElBQUk7UUFDRixJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksRUFBRSxDQUFDO0lBQ3pCLENBQUM7SUFFRDs7T0FFRztJQUNILE1BQU07UUFDSixJQUFJLENBQUMsVUFBVSxDQUFDLE1BQU0sRUFBRSxDQUFDO0lBQzNCLENBQUM7SUFFRDs7T0FFRztJQUNILFFBQVE7UUFDTixJQUFJLENBQUMsVUFBVSxDQUFDLFFBQVEsRUFBRSxDQUFDO0lBQzdCLENBQUM7SUFFRDs7T0FFRztJQUNI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b0I7WUFDL0Msa0JBQWtCLEVBQUUsSUFBSSxDQUFDLGtCQUFrQjtZQUMzQyxrQkFBa0IsRUFBRSxJQUFJLENBQUMsa0JBQWtCO1lBQzNDLFFBQVEsRUFBRSxJQUFJLENBQUMsUUFBUTtZQUN2QixlQUFlLEVBQUUsSUFBSSxDQUFDLEtBQUs7WUFDM0IsU0FBUyxFQUFFLElBQUksQ0FBQyxTQUFTO1NBQzFCLENBQUMsQ0FBQztRQUVILFVBQVUsQ0FBQyxFQUFFLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxVQUFVLENBQUMsQ0FBQyxDQUFDO1FBQ3BFLFVBQVUsQ0FBQyxFQUFFLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDO1FBRWhFLElBQUksQ0FBQyxVQUFVLEdBQUcsVUFBVSxDQUFDO0lBQy9CLENBQUM7aUlBdEpVLGVBQWU7cUlBQWYsZUFBZSxjQUZkLE1BQU07OzJGQUVQLGVBQWU7a0JBSDNCLFVBQVU7bUJBQUM7b0JBQ1YsVUFBVSxFQUFFLE1BQU07aUJBQ25CIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IFNoZXBoZXJkIGZyb20gJ3NoZXBoZXJkLmpzJztcbmltcG9ydCB7IGVsZW1lbnRJc0hpZGRlbiB9IGZyb20gJy4vdXRpbHMvZG9tJztcbmltcG9ydCB7IG1ha2VCdXR0b24gfSBmcm9tICcuL3V0aWxzL2J1dHRvbnMnO1xuaW1wb3J0IFN0ZXAgZnJvbSAnc2hlcGhlcmQuanMvc3JjL3R5cGVzL3N0ZXAnO1xuQEluamVjdGFibGUoe1xuICBwcm92aWRlZEluOiAncm9vdCdcbn0pXG5leHBvcnQgY2xhc3MgU2hlcGhlcmRTZXJ2aWNlIHtcbiAgY29uZmlybUNhbmNlbCA9IGZhbHNlO1xuICBjb25maXJtQ2FuY2VsTWVzc2FnZTogc3RyaW5nID0gbnVsbDtcbiAgZGVmYXVsdFN0ZXBPcHRpb25zOiBTdGVwLlN0ZXBPcHRpb25zID0ge307XG4gIGVycm9yVGl0bGUgPSBudWxsO1xuICBpc0FjdGl2ZSA9IGZhbHNlO1xuICBrZXlib2FyZE5hdmlnYXRpb24gPSB0cnVlO1xuICBtZXNzYWdlRm9yVXNlcjogc3RyaW5nID0gbnVsbDtcbiAgbW9kYWwgPSBmYWxzZTtcbiAgcmVxdWlyZWRFbGVtZW50cyA9IFtdO1xuICB0b3VyTmFtZSA9IHVuZGVmaW5lZDtcbiAgdG91ck9iamVjdDogU2hlcGhlcmQuVG91ciA9IG51bGw7XG4gIGV4aXRPbkVzYyA9IHRydWU7XG5cbiAgY29uc3RydWN0b3IgKCkge1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgdG91ciBvYmplY3QgYW5kIGNhbGwgYmFja1xuICAgKi9cbiAgYmFjaygpIHtcbiAgICB0aGlzLnRvdXJPYmplY3QuYmFjaygpO1xuICB9XG5cbiAgLyoqXG4gICAqIENhbmNlbCB0aGUgdG91clxuICAgKi9cbiAgY2FuY2VsKCkge1xuICAgIHRoaXMudG91ck9iamVjdC5jYW5jZWwoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDb21wbGV0ZSB0aGUgdG91clxuICAgKi9cbiAgY29tcGxldGUoKSB7XG4gICAgdGhpcy50b3VyT2JqZWN0LmNvbXBsZXRlKCk7XG4gIH1cblxuICAvKipcbiAgICogSGlkZXMgdGhlIGN1cnJlbnQgc3RlcFxuICAgKi9cbiAgaGlkZSgpIHtcbiAgICB0aGlzLnRvdXJPYmplY3QuaGlkZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkdmFuY2UgdGhlIHRvdXIgdG8gdGhlIG5leHQgc3RlcFxuICAgKi9cbiAgbmV4dCgpIHtcbiAgICB0aGlzLnRvdXJPYmplY3QubmV4dCgpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNob3cgYSBzcGVjaWZpYyBzdGVwLCBieSBwYXNzaW5nIGl0cyBpZFxuICAgKiBAcGFyYW0gaWQgVGhlIGlkIG9mIHRoZSBzdGVwIHlvdSB3YW50IHRvIHNob3dcbiAgICovXG4gIHNob3coaWQ6IHN0cmluZyB8IG51bWJlcikge1xuICAgIHRoaXMudG91ck9iamVjdC5zaG93KGlkKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTdGFydCB0aGUgdG91clxuICAgKi9cbiAgc3RhcnQoKSB7XG4gICAgdGhpcy5pc0FjdGl2ZSA9IHRydWU7XG4gICAgdGhpcy50b3VyT2JqZWN0LnN0YXJ0KCk7XG4gIH1cblxuICAvKipcbiAgICogVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgd2hlbiBhIHRvdXIgaXMgY29tcGxldGVkIG9yIGNhbmNlbGxlZCB0byBpbml0aWF0ZSBjbGVhbnVwLlxuICAgKiBAcGFyYW0gY29tcGxldGVPckNhbmNlbCAnY29tcGxldGUnIG9yICdjYW5jZWwnXG4gICAqL1xuICBvblRvdXJGaW5pc2goY29tcGxldGVPckNhbmNlbDogc3RyaW5nKSB7XG4gICAgdGhpcy5pc0FjdGl2ZSA9IGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIFRha2UgYSBzZXQgb2Ygc3RlcHMgYW5kIGNyZWF0ZSBhIHRvdXIgb2JqZWN0IGJhc2VkIG9uIHRoZSBjdXJyZW50IGNvbmZpZ3VyYXRpb25cbiAgICogQHBhcmFtIHN0ZXBzIEFuIGFycmF5IG9mIHN0ZXBzXG4gICAqL1xuICBhZGRTdGVwcyhzdGVwczogQXJyYXk8U3RlcC5TdGVwT3B0aW9ucz4pIHtcbiAgICB0aGlzLl9pbml0aWFsaXplKCk7XG4gICAgY29uc3QgdG91ciA9IHRoaXMudG91ck9iamVjdDtcblxuICAgIC8vIFJldHVybiBub3RoaW5nIGlmIHRoZXJlIGFyZSBubyBzdGVwc1xuICAgIGlmICghc3RlcHMgfHwgIUFycmF5LmlzQXJyYXkoc3RlcHMpIHx8IHN0ZXBzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5yZXF1aXJlZEVsZW1lbnRzUHJlc2VudCgpKSB7XG4gICAgICB0b3VyLmFkZFN0ZXAoe1xuICAgICAgICBidXR0b25zOiBbe1xuICAgICAgICAgIHRleHQ6ICdFeGl0JyxcbiAgICAgICAgICBhY3Rpb246IHRvdXIuY2FuY2VsXG4gICAgICAgIH1dLFxuICAgICAgICBpZDogJ2Vycm9yJyxcbiAgICAgICAgdGl0bGU6IHRoaXMuZXJyb3JUaXRsZSxcbiAgICAgICAgdGV4dDogW3RoaXMubWVzc2FnZUZvclVzZXJdXG4gICAgICB9KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBzdGVwcy5mb3JFYWNoKChzdGVwKSA9PiB7XG4gICAgICBpZiAoc3RlcC5idXR0b25zKSB7XG4gICAgICAgIHN0ZXAuYnV0dG9ucyA9IHN0ZXAuYnV0dG9ucy5tYXAobWFrZUJ1dHRvbi5iaW5kKHRoaXMpLCB0aGlzKTtcbiAgICAgIH1cblxuICAgICAgdG91ci5hZGRTdGVwKHN0ZXApO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIE9ic2VydmVzIHRoZSBhcnJheSBvZiByZXF1aXJlZEVsZW1lbnRzLCB3aGljaCBhcmUgdGhlIGVsZW1lbnRzIHRoYXQgbXVzdCBiZSBwcmVzZW50IGF0IHRoZSBzdGFydCBvZiB0aGUgdG91cixcbiAgICogYW5kIGRldGVybWluZXMgaWYgdGhleSBleGlzdCwgYW5kIGFyZSB2aXNpYmxlLCBpZiBlaXRoZXIgaXMgZmFsc2UsIGl0IHdpbGwgc3RvcCB0aGUgdG91ciBmcm9tIGV4ZWN1dGluZy5cbiAgICovXG4gIHByaXZhdGUgcmVxdWlyZWRFbGVtZW50c1ByZXNlbnQoKSB7XG4gICAgbGV0IGFsbEVsZW1lbnRzUHJlc2VudCA9IHRydWU7XG5cbiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dDogYWxzbyBjYW4ndCB0ZXN0IHRoaXMgZHVlIHRvIHRoaW5ncyBhdHRhY2hlZCB0byByb290IGJsb3dpbmcgdXAgdGVzdHMgKi9cbiAgICB0aGlzLnJlcXVpcmVkRWxlbWVudHMuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xuICAgICAgY29uc3Qgc2VsZWN0ZWRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlbGVtZW50LnNlbGVjdG9yKTtcblxuICAgICAgaWYgKGFsbEVsZW1lbnRzUHJlc2VudCAmJiAoIXNlbGVjdGVkRWxlbWVudCB8fCBlbGVtZW50SXNIaWRkZW4oc2VsZWN0ZWRFbGVtZW50KSkpIHtcbiAgICAgICAgYWxsRWxlbWVudHNQcmVzZW50ID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZXJyb3JUaXRsZSA9IGVsZW1lbnQudGl0bGU7XG4gICAgICAgIHRoaXMubWVzc2FnZUZvclVzZXIgPSBlbGVtZW50Lm1lc3NhZ2U7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gYWxsRWxlbWVudHNQcmVzZW50O1xuICB9XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemVzIHRoZSB0b3VyLCBjcmVhdGVzIGEgbmV3IFNoZXBoZXJkLlRvdXIuIHNldHMgb3B0aW9ucywgYW5kIGJpbmRzIGV2ZW50c1xuICAgKi9cbiAgcHJpdmF0ZSBfaW5pdGlhbGl6ZSgpIHtcbiAgICBjb25zdCB0b3VyT2JqZWN0ID0gbmV3IFNoZXBoZXJkLlRvdXIoe1xuICAgICAgY29uZmlybUNhbmNlbDogdGhpcy5jb25maXJtQ2FuY2VsLFxuICAgICAgY29uZmlybUNhbmNlbE1lc3NhZ2U6IHRoaXMuY29uZmlybUNhbmNlbE1lc3NhZ2UsXG4gICAgICBkZWZhdWx0U3RlcE9wdGlvbnM6IHRoaXMuZGVmYXVsdFN0ZXBPcHRpb25zLFxuICAgICAga2V5Ym9hcmROYXZpZ2F0aW9uOiB0aGlzLmtleWJvYXJkTmF2aWdhdGlvbixcbiAgICAgIHRvdXJOYW1lOiB0aGlzLnRvdXJOYW1lLFxuICAgICAgdXNlTW9kYWxPdmVybGF5OiB0aGlzLm1vZGFsLFxuICAgICAgZXhpdE9uRXNjOiB0aGlzLmV4aXRPbkVzY1xuICAgIH0pO1xuXG4gICAgdG91ck9iamVjdC5vbignY29tcGxldGUnLCB0aGlzLm9uVG91ckZpbmlzaC5iaW5kKHRoaXMsICdjb21wbGV0ZScpKTtcbiAgICB0b3VyT2JqZWN0Lm9uKCdjYW5jZWwnLCB0aGlzLm9uVG91ckZpbmlzaC5iaW5kKHRoaXMsICdjYW5jZWwnKSk7XG5cbiAgICB0aGlzLnRvdXJPYmplY3QgPSB0b3VyT2JqZWN0O1xuICB9XG59XG4iXX0=